# NPC与任务系统设计

## 系统概述

NPC系统是游戏的灵魂，通过丰富的角色塑造和任务设计，让玩家在末日小镇中建立情感连接。任务系统则是推动剧情、提升属性、获取资源的核心途径。

**核心特点：**
- 50+个有深度的NPC角色
- 动态好感度系统
- 多样化的任务类型
- 任务与六维属性深度绑定
- NPC之间有复杂的关系网

---

## NPC系统

### NPC分类

#### 核心NPC（10-15个）

拥有完整的个人剧情线，可以深度互动。

**特征：**
- 独特的背景故事
- 完整的好感度系统
- 个人任务链（5-10个任务）
- 可能成为战斗同伴
- 影响主线剧情走向

**示例核心NPC：**

1. **艾琳（Erin）- 小镇医生**
   - 年龄：32岁
   - 性格：温柔、坚强、有责任感
   - 背景：末日前是外科医生，现在是小镇唯一的医疗人员
   - 关联属性：智慧、魅力
   - 个人剧情：寻找失踪的丈夫，研究感染病毒
   - 战斗能力：辅助型，提供治疗和增益

2. **马库斯（Marcus）- 前军人**
   - 年龄：45岁
   - 性格：严肃、可靠、有原则
   - 背景：退役特种兵，负责小镇防御
   - 关联属性：力量、勇气
   - 个人剧情：保护小镇，训练民兵，面对过去的创伤
   - 战斗能力：坦克型，高血量高防御

3. **莉莉（Lily）- 年轻拾荒者**
   - 年龄：19岁
   - 性格：活泼、机灵、乐观
   - 背景：末日后长大的一代，擅长寻找物资
   - 关联属性：技巧、勇气
   - 个人剧情：寻找父母的下落，证明自己的价值
   - 战斗能力：敏捷型，高闪避高暴击

4. **老约翰（John）- 铁匠**
   - 年龄：58岁
   - 性格：固执、热心、经验丰富
   - 背景：小镇原住民，掌握传统锻造技术
   - 关联属性：力量、技巧
   - 个人剧情：传承技艺，保护小镇传统
   - 战斗能力：不参与战斗，但提供装备支持

5. **索菲亚（Sophia）- 神秘商人**
   - 年龄：？？？
   - 性格：神秘、精明、知识渊博
   - 背景：来历不明，似乎知道很多秘密
   - 关联属性：智慧、财富
   - 个人剧情：揭开她的真实身份，了解末日真相
   - 战斗能力：未知

#### 重要NPC（20-25个）

有一定深度，提供任务和服务。

**特征：**
- 简单的背景故事
- 基础好感度系统
- 2-5个任务
- 提供特定服务（商店、训练等）

**示例：**
- 酒馆老板
- 图书管理员
- 农场主
- 工坊师傅
- 巡逻队长
- 教师
- 孤儿院院长

#### 普通NPC（20-30个）

填充小镇，增加真实感。

**特征：**
- 基础对话
- 可能提供简单任务
- 参与集体活动
- 提供情报和氛围

---

### 好感度系统

#### 好感度等级


| 等级 | 名称 | 好感度范围 | 解锁内容 |
|------|------|------------|----------|
| 0 | 陌生人 | 0-20 | 基础对话 |
| 1 | 认识 | 21-40 | 简单任务、基础交易 |
| 2 | 熟人 | 41-60 | 个人故事片段、特殊交易 |
| 3 | 朋友 | 61-80 | 深度任务、可作为同伴 |
| 4 | 挚友 | 81-95 | 个人剧情高潮、特殊技能传授 |
| 5 | 灵魂伴侣 | 96-100 | 完整剧情结局、独特奖励 |

#### 好感度获取方式

**对话选择：**
- 正确的对话选择：+2-5好感度
- 中性选择：+0-1好感度
- 错误选择：-3-10好感度

**完成任务：**
- 简单任务：+5好感度
- 中等任务：+10好感度
- 困难任务：+15好感度
- 个人剧情任务：+20好感度

**赠送礼物：**
- 普通物品：+1-3好感度
- 喜欢的物品：+5-8好感度
- 最爱的物品：+10-15好感度
- 讨厌的物品：-5好感度

**日常互动：**
- 每日问候：+1好感度（每天一次）
- 参与NPC活动：+3好感度
- 帮助NPC解决问题：+5好感度

**特殊事件：**
- 在危机中保护NPC：+20好感度
- 完成NPC心愿：+25好感度
- 背叛或伤害NPC：-30-50好感度

#### 好感度影响

**交易折扣：**
- 陌生人：正常价格
- 认识：95%价格
- 熟人：90%价格
- 朋友：85%价格
- 挚友：80%价格
- 灵魂伴侣：75%价格+独家商品

**战斗支援：**
- 好感度60+：可邀请作为临时同伴
- 好感度80+：战斗中提供额外支援
- 好感度95+：解锁组合技能

**剧情影响：**
- 某些剧情选择需要特定NPC的高好感度
- 低好感度可能导致NPC离开或敌对
- 高好感度解锁隐藏结局

---

### NPC日程系统

每个NPC都有自己的日常作息，增加真实感。

#### 时间段划分

**早晨（6:00-9:00）：**
- 起床、洗漱
- 早餐
- 准备一天的工作

**上午（9:00-12:00）：**
- 工作时间
- 在固定地点提供服务

**中午（12:00-14:00）：**
- 午餐时间
- 可能在酒馆或家中

**下午（14:00-18:00）：**
- 继续工作
- 或进行个人活动

**傍晚（18:00-20:00）：**
- 晚餐时间
- 社交活动

**夜晚（20:00-23:00）：**
- 休闲时间
- 在酒馆或家中

**深夜（23:00-6:00）：**
- 睡眠时间
- 大部分NPC不可互动

#### 特殊日程

**周末活动：**
- 周六：集市日，NPC聚集在广场
- 周日：休息日，NPC在家或参加社区活动

**节日活动：**
- 丰收节、冬至节等
- NPC有特殊对话和任务

**天气影响：**
- 下雨天：室内活动增加
- 暴风雪：大部分NPC待在家中

**紧急事件：**
- 感染者袭击：战斗人员集合
- 物资短缺：NPC行为改变

---

### NPC关系网

NPC之间有复杂的关系，影响任务和剧情。

#### 关系类型

**家庭关系：**
- 父母子女
- 兄弟姐妹
- 夫妻/伴侣

**社交关系：**
- 朋友
- 竞争对手
- 师徒
- 同事

**情感关系：**
- 暗恋
- 前任
- 仇人
- 恩人

#### 关系影响

**连锁任务：**
- 帮助A可能得罪B
- 某些任务需要多个NPC的协助

**对话变化：**
- NPC会谈论其他NPC
- 关系好的NPC会互相推荐

**剧情分支：**
- NPC关系影响剧情走向
- 可能需要调解NPC矛盾

---

## 任务系统

### 任务分类

#### 主线任务

推动主要剧情发展。

**特点：**
- 线性或分支剧情
- 重大奖励
- 影响游戏结局
- 与核心NPC深度关联

**示例主线任务链：**

1. **序章：觉醒**
   - 目标：了解自己的处境
   - 奖励：基础装备、解锁小镇
   - 属性要求：无

2. **第一章：融入小镇**
   - 目标：获得小镇居民的信任
   - 奖励：住所、基础资源
   - 属性要求：魅力20+

3. **第二章：第一次危机**
   - 目标：协助防御感染者袭击
   - 奖励：武器升级、好感度提升
   - 属性要求：力量30+或技巧30+

4. **第三章：揭开秘密**
   - 目标：调查末日真相
   - 奖励：关键情报、新区域解锁
   - 属性要求：智慧40+

5. **第四章：艰难抉择**
   - 目标：在不同派系间做出选择
   - 奖励：派系支持、独特技能
   - 属性要求：多维度50+

6. **终章：命运之战**
   - 目标：根据选择面对最终挑战
   - 奖励：游戏结局
   - 属性要求：全面发展

#### 支线任务

丰富游戏内容，提供额外奖励。

**类型：**

**个人剧情任务：**
- 与核心NPC的故事相关
- 多阶段任务链
- 深度角色塑造
- 高价值奖励

**社区任务：**
- 帮助小镇发展
- 建设设施
- 组织活动
- 提升小镇等级

**探索任务：**
- 探索新区域
- 寻找特殊物品
- 调查神秘事件
- 解锁地图

**收集任务：**
- 收集特定物品
- 完成图鉴
- 获取稀有资源
- 解锁配方

#### 日常任务

可重复完成，提供稳定收益。

**类型：**

**资源采集：**
- 收集食物、水、木材等
- 奖励：基础资源、少量经验
- 每日可完成3次

**巡逻任务：**
- 清理周边感染者
- 奖励：战斗经验、弹药
- 每日可完成2次

**制作任务：**
- 制作指定物品
- 奖励：技巧经验、金钱
- 每日可完成5次

**社交任务：**
- 与NPC互动
- 奖励：好感度、情报
- 每日可完成10次

#### 紧急任务

随机触发，限时完成。

**特点：**
- 突发事件触发
- 时间限制
- 高风险高回报
- 可能失败

**示例：**
- 感染者突袭：30分钟内防御
- NPC遇险：20分钟内救援
- 物资争夺：与其他幸存者竞争
- 神秘商人：限时交易机会

---

### 任务设计原则

#### 属性关联

每个任务都与六维属性深度绑定。

**力量相关任务：**
- 搬运重物
- 破坏障碍
- 近战战斗
- 保护他人

**技巧相关任务：**
- 修理设备
- 制作物品
- 远程战斗
- 潜行行动

**智慧相关任务：**
- 解谜
- 研究
- 策略规划
- 医疗救助

**魅力相关任务：**
- 说服NPC
- 谈判交易
- 组织活动
- 化解冲突

**勇气相关任务：**
- 探索危险区域
- 面对恐惧
- 做出艰难决定
- 保护弱者

**财富相关任务：**
- 商业交易
- 资源管理
- 投资建设
- 寻宝探险

#### 多解决方案

大部分任务提供多种完成方式。

**示例：进入封锁区域**

**方案1：力量路线**
- 要求：力量50+
- 方法：破坏大门
- 结果：快速但引起注意

**方案2：技巧路线**
- 要求：技巧40+
- 方法：撬锁或找到通风口
- 结果：安静但耗时

**方案3：智慧路线**
- 要求：智慧45+
- 方法：破解电子锁或找到密码
- 结果：最优解，无副作用

**方案4：魅力路线**
- 要求：魅力35+，与守卫好感度50+
- 方法：说服守卫放行
- 结果：最简单但需要前置条件

**方案5：财富路线**
- 要求：财富30+，500金币
- 方法：贿赂守卫
- 结果：简单但花费高

#### 选择与后果

玩家的选择会产生长远影响。

**道德选择：**
- 帮助弱者 vs 自保
- 说真话 vs 撒谎
- 分享资源 vs 独占

**派系选择：**
- 支持不同的领导者
- 加入不同的组织
- 影响小镇政治

**资源分配：**
- 个人发展 vs 社区建设
- 短期收益 vs 长期投资
- 安全 vs 自由

**后果系统：**
- 立即后果：任务奖励变化
- 短期后果：NPC态度改变
- 长期后果：剧情分支、结局影响

---

### 任务奖励系统

#### 经验奖励

**属性经验：**
- 根据任务类型分配到对应属性
- 主线任务：50-200经验
- 支线任务：20-100经验
- 日常任务：5-20经验

**等级经验：**
- 用于提升角色总等级
- 解锁新技能和能力

#### 物质奖励

**货币：**
- 金币：通用货币
- 贡献点：小镇内部货币
- 派系声望：特殊组织货币

**物品：**
- 装备：武器、防具、配饰
- 消耗品：药品、食物、弹药
- 材料：制作和升级用
- 特殊物品：剧情道具、收藏品

**配方和技能：**
- 制作配方
- 战斗技能
- 生活技能
- 特殊能力

#### 关系奖励

**好感度：**
- 任务委托人好感度提升
- 相关NPC好感度变化

**声望：**
- 小镇声望
- 派系声望
- 区域声望

**解锁内容：**
- 新任务线
- 新区域
- 新功能
- 隐藏内容

---

## 任务追踪系统

### 任务日志

**分类显示：**
- 主线任务（高亮显示）
- 支线任务（按NPC分类）
- 日常任务（按类型分类）
- 紧急任务（倒计时显示）

**任务信息：**
- 任务名称和描述
- 当前目标
- 可选目标
- 奖励预览
- 建议属性等级
- 任务委托人

### 任务提示

**目标追踪：**
- 屏幕上显示当前目标
- 地图标记目标位置
- 距离和方向指示

**进度提示：**
- 收集类任务显示进度
- 多阶段任务显示当前阶段
- 时间限制任务显示倒计时

**智能提示：**
- 属性不足时给出提示
- 推荐完成顺序
- 相关任务关联提示

---

## 特殊系统

### 任务委托板

**位置：**
- 小镇中心广场
- 酒馆
- 各个工坊

**功能：**
- 查看可接取的任务
- 按难度、类型、奖励筛选
- 查看任务评价和完成率

**任务更新：**
- 每日刷新日常任务
- 每周刷新部分支线任务
- 随机出现特殊任务

### 合作任务

**多人协作：**
- 某些任务需要多个NPC协助
- 需要协调NPC的时间和能力
- 奖励更丰厚

**示例：**
- 大型建筑项目：需要铁匠、木匠、工人
- 探险任务：需要战士、医生、向导
- 研究项目：需要科学家、助手、资源

### 任务失败机制

**失败条件：**
- 超时
- 关键NPC死亡
- 任务物品损坏
- 玩家死亡

**失败后果：**
- 无法获得奖励
- 可能降低好感度
- 某些任务无法重试
- 影响后续剧情

**补救措施：**
- 部分任务可以重试
- 可以通过其他方式弥补
- 某些失败会开启新的剧情线

---

## 动态事件系统

### 随机事件

**小镇事件：**
- 节日庆典
- NPC生日
- 突发事故
- 商队到访

**世界事件：**
- 天气变化
- 感染者迁徙
- 其他幸存者团体
- 资源点刷新

**个人事件：**
- NPC求助
- 意外发现
- 随机遭遇
- 特殊机遇

### 连锁反应

**事件影响：**
- 一个事件可能触发其他事件
- NPC关系影响事件走向
- 玩家选择改变事件结果

**示例连锁：**
1. 商队到访 → 带来新物资和情报
2. 情报揭示新威胁 → 触发防御任务
3. 防御成功 → 获得商队信任
4. 商队信任 → 解锁贸易路线
5. 贸易路线 → 小镇繁荣度提升

---

## 数据示例

### 核心NPC完整数据（艾琳）

```
NPC ID: NPC_001
名称: 艾琳 (Erin)
年龄: 32
职业: 医生
性格标签: [温柔, 坚强, 责任感]

初始好感度: 30
好感度上限: 100

喜好物品:
- 医疗用品 (+15)
- 书籍 (+10)
- 咖啡 (+8)
- 鲜花 (+5)

讨厌物品:
- 酒精 (-5)
- 武器 (-3)

日程表:
  周一-周五:
    06:00-09:00: 家中
    09:00-12:00: 诊所
    12:00-13:00: 酒馆
    13:00-18:00: 诊所
    18:00-20:00: 家中
    20:00-23:00: 图书馆
    23:00-06:00: 家中(睡眠)
  
  周末:
    特殊活动

关系网:
- 马库斯: 朋友 (信任)
- 索菲亚: 熟人 (好奇)
- 莉莉: 照顾 (关心)

个人任务链:
1. 初次见面 (好感度0+)
2. 医疗援助 (好感度20+)
3. 寻找药品 (好感度40+)
4. 丈夫的线索 (好感度60+)
5. 病毒研究 (好感度80+)
6. 最终真相 (好感度95+)

战斗数据:
- 生命值: 80
- 攻击力: 15
- 防御力: 10
- 技能: 治疗术, 急救, 状态解除
```

### 任务数据示例

```
任务ID: QUEST_MAIN_003
任务名称: 第一次危机
任务类型: 主线任务
任务阶段: 第二章

前置条件:
- 完成任务: QUEST_MAIN_002
- 小镇声望: 30+
- 角色等级: 5+

任务描述:
"感染者群正在接近小镇，马库斯需要你的帮助来组织防御。"

任务目标:
1. 与马库斯对话
2. 准备防御工事 (0/5)
3. 召集民兵 (0/10)
4. 击退感染者 (0/30)
5. 检查伤亡情况

可选目标:
- 零伤亡完成防御 (+50经验)
- 保护所有建筑 (+30经验)
- 击杀感染者首领 (+特殊奖励)

属性要求:
- 力量30+ 或 技巧30+ 或 智慧35+
- 勇气25+

时间限制: 无

奖励:
- 经验: 力量+50, 勇气+30
- 金币: 500
- 物品: 改良武器 x1
- 好感度: 马库斯+20, 全体小镇居民+5
- 解锁: 民兵训练系统

失败条件:
- 小镇核心建筑被摧毁
- 超过50%居民伤亡
- 玩家死亡

失败后果:
- 小镇声望-20
- 部分NPC死亡
- 开启"重建"支线
```

---

## 平衡性考虑

### 任务数量平衡

**总任务量：**
- 主线任务: 20-30个
- 核心NPC支线: 50-80个
- 普通支线: 100-150个
- 日常任务: 20-30种（可重复）
- 紧急任务: 30-50种（随机）

**游戏时长：**
- 主线流程: 15-20小时
- 全支线完成: 40-60小时
- 完美通关: 80-100小时

### 难度曲线

**前期（1-10级）：**
- 简单任务为主
- 教学引导
- 低风险低回报

**中期（11-25级）：**
- 难度逐渐提升
- 多样化任务类型
- 开始出现选择分支

**后期（26-40级）：**
- 高难度挑战
- 复杂的任务链
- 重大选择和后果

**终局（40级+）：**
- 最终挑战
- 多结局分支
- 隐藏内容

### 奖励平衡

**经验获取：**
- 每级所需经验递增
- 多种途径获取经验
- 避免单一刷经验方式

**物品获取：**
- 稀有物品通过特定任务获得
- 避免过度依赖随机掉落
- 保持物品价值感

**好感度获取：**
- 需要长期投入
- 避免快速刷满
- 保持互动的意义

---

## 未来扩展

### DLC内容

**新NPC：**
- 5-10个新核心NPC
- 新的关系网
- 新的任务链

**新区域：**
- 新的探索区域
- 新的任务类型
- 新的敌人和挑战

**新系统：**
- 浪漫关系系统
- 家庭系统
- 派系战争系统

### 社区功能

**玩家分享：**
- 任务完成方式分享
- NPC互动心得
- 剧情选择讨论

**成就系统：**
- 任务相关成就
- NPC相关成就
- 隐藏成就

---

## 总结

NPC与任务系统是游戏的核心，通过：

1. **丰富的NPC角色**：50+个有深度的角色，每个都有独特的故事
2. **动态好感度系统**：深度互动，建立情感连接
3. **多样化任务**：主线、支线、日常、紧急，满足不同玩家需求
4. **属性深度绑定**：任务与六维属性紧密结合，鼓励全面发展
5. **选择与后果**：玩家的决定影响剧情走向和游戏结局
6. **动态世界**：NPC有自己的生活，世界持续运转

这个系统将为玩家提供一个充满生命力的末日小镇，让每一次互动都充满意义，每一个选择都值得深思。

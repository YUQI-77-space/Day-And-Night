# 2026年2月12日开发工作计划

> **日期：** 2026-02-12
> **任务类型：** 核心管理器场景整合与UI预制体搭建
> **承接进度：** 11个核心管理器代码已全部实现（不含BaseManager/IManager基类）
> **预计工时：** 4-6小时

---

## 核心管理器清单

| 序号 | 管理器名称 | 脚本文件 | 当前状态 |
|------|-----------|----------|----------|
| 1 | EventManager | EventManager.cs | ✅ 已挂载 |
| 2 | AudioManager | AudioManager.cs | ✅ 已挂载 |
| 3 | SaveManager | SaveManager.cs | ✅ 已挂载 |
| 4 | DataManager | DataManager.cs | ✅ 已挂载 |
| 5 | TimeManager | TimeManager.cs | ⚠️ 空GameObject |
| 6 | SceneLoader | SceneLoader.cs | ⚠️ 空GameObject |
| 7 | UIManager | UIManager.cs | ⚠️ 空GameObject |
| 8 | InputManager | InputManager.cs | ❌ 完全缺失 |
| 9 | GameStateManager | GameStateManager.cs | ❌ 完全缺失 |
| 10 | GameManager | GameManager.cs | ❌ 完全缺失 |
| 11 | DialogueManager | DialogueManager.cs | ⚠️ 场景内独立挂载 |

---

## 今日工作目标

### 总体目标

完成核心管理器模块的**场景整合与UI预制体搭建**，将已实现的11个核心管理器代码与Unity场景、预制体进行关联配置，确保游戏能够正常启动并运行。

### 预期结果

| 功能 | 预期结果 | 验证方式 |
|------|----------|----------|
| GameManagers预制体完整配置 | 所有管理器组件正确挂载 | Inspector检查 |
| UI预制体创建完成 | 主菜单、暂停、加载界面可显示 | Unity运行测试 |
| 主菜单场景整合 | 游戏启动显示主菜单 | 运行游戏观察 |
| 管理器初始化流程 | 所有管理器按依赖顺序初始化 | 控制台日志 |

---

## 今日工作清单

### 任务1：完善GameManagers.prefab配置

**涉及文件：**
- `Assets/_Project/Prefabs/Environment/GameManagers.prefab`

**当前状态：**
- ⚠️ 预制体包含7个子对象：4个已挂载组件，3个为空GameObject
- ❌ 完全缺失3个子对象（InputSystem、GameStateSystem、GameManager）

**需要完善/添加的子对象：**

| 序号 | 子对象名称 | 当前状态 | 挂载组件 | 依赖说明 |
|------|-----------|----------|----------|----------|
| 1 | TimeSystem | 空GameObject | TimeManager | 依赖DataManager |
| 2 | SceneSystem | 空GameObject | SceneLoader | 依赖EventManager |
| 3 | UISystem | 空GameObject | UIManager | 依赖EventManager、SceneLoader |
| 4 | InputSystem | 完全缺失 | InputManager | 无依赖 |
| 5 | GameStateSystem | 完全缺失 | GameStateManager | 依赖EventManager |
| 6 | GameManager | 完全缺失 | GameManager | 依赖所有管理器 |

**操作步骤：**
1. 在Unity中打开GameManagers.prefab
2. 为TimeSystem、SceneSystem、UISystem三个空对象挂载对应Manager脚本
3. 创建InputSystem、GameStateSystem、GameManager三个子对象并挂载脚本
4. 确保各组件的依赖引用正确配置
5. 设置DontDestroyOnLoad（保持跨场景存在）
6. 配置各管理器的核心属性（见下方补充说明）

**补充配置说明：**

| 管理器 | 必配属性 |
|--------|----------|
| EventManager | 启用EventHistory（调试用），设置最大历史记录数 |
| AudioManager | 配置MusicSource和SFXSources音频源组件 |
| DataManager | 关联GameConfig配置资源（ScriptableObject） |
| SaveManager | 设置自动保存开关、间隔时间、最大存档数 |
| UIManager | 配置各UI面板引用、设置默认层级 |
| SceneLoader | 关联LoadingPanel预制体、配置进度条引用 |
| TimeManager | 配置时间流速、日期初始值 |
| InputManager | 配置输入动作Asset（Input System） |
| GameStateManager | 配置初始游戏状态 |
| GameManager | 作为主控制器，无需特殊配置 |

**验证标准：**
- [ ] Inspector中显示10个子对象全部存在（含GameManagers根对象）
- [ ] 每个子对象挂载了正确的脚本组件
- [ ] 组件间引用关系正确配置（无空引用）
- [ ] DontDestroyOnLoad设置正确

---

### 任务2：创建UI预制体

**涉及目录：**
- `Assets/_Project/Prefabs/UI/`

**当前状态：**
- ❌ UI预制体文件夹为空
- ⚠️ UI脚本已创建（MainMenuUI.cs, PauseMenuUI.cs, LoadingUI.cs, DialogueUI.cs）

**需要创建的预制体清单：**

#### 2.1 主菜单面板 (MainMenuPanel)

| 属性 | 说明 |
|------|------|
| 预制体路径 | Assets/_Project/Prefabs/UI/MainMenuPanel.prefab |
| 挂载组件 | MainMenuUI, CanvasRenderer, RectTransform等 |
| 依赖资源 | 主菜单背景图、按钮精灵、音效资源 |

**UI元素清单：**
- [ ] 背景图（1920x1080）
- [ ] 游戏标题Logo
- [ ] 新游戏按钮（NewGameButton）
- [ ] 继续游戏按钮（ContinueGameButton）
- [ ] 设置按钮（SettingsButton）
- [ ] 关于按钮（AboutButton）
- [ ] 退出游戏按钮（QuitButton）
- [ ] 设置面板（SettingsPanel）
- [ ] 关于面板（AboutPanel）
- [ ] 存档选择面板（SaveSlotPanel）

#### 2.2 暂停菜单面板 (PauseMenuPanel)

| 属性 | 说明 |
|------|------|
| 预制体路径 | Assets/_Project/Prefabs/UI/PauseMenuPanel.prefab |
| 挂载组件 | PauseMenuUI, CanvasRenderer, RectTransform等 |
| 依赖资源 | 暂停菜单背景、按钮精灵 |

**UI元素清单：**
- [ ] 半透明黑色遮罩背景
- [ ] 暂停标题
- [ ] 继续游戏按钮
- [ ] 保存游戏按钮
- [ ] 设置按钮
- [ ] 返回主菜单按钮
- [ ] 退出游戏按钮

#### 2.3 加载界面面板 (LoadingPanel)

| 属性 | 说明 |
|------|------|
| 预制体路径 | Assets/_Project/Prefabs/UI/LoadingPanel.prefab |
| 挂载组件 | LoadingUI, CanvasRenderer, RectTransform等 |
| 依赖资源 | 进度条背景、进度条填充、加载背景图 |

**UI元素清单：**
- [ ] 全屏背景图（可选淡入效果）
- [ ] 进度条背景（ProgressBarBG）
- [ ] 进度条填充（ProgressBarFill）- Image Type: Filled
- [ ] 百分比文本（ProgressPercentText）
- [ ] 加载状态文本（ProgressText）
- [ ] 场景名称文本（SceneNameText）
- [ ] 加载提示文本（LoadingTipText）

#### 2.4 对话框面板 (DialoguePanel)

| 属性 | 说明 |
|------|------|
| 预制体路径 | Assets/_Project/Prefabs/UI/DialoguePanel.prefab |
| 挂载组件 | DialogueUI, CanvasRenderer, RectTransform等 |
| 依赖资源 | 对话框背景、角色立绘、音效资源 |

**UI元素清单：**
- [ ] 对话框底部背景
- [ ] 角色立绘显示区（左/右）
- [ ] 对话内容文本
- [ ] 角色名称文本
- [ ] 继续提示箭头（"按任意键继续"）
- [ ] 选项按钮组（用于分支对话）

---

### 任务3：主菜单场景整合

**涉及文件：**
- `Assets/_Project/Scenes/Main/Main.unity`

**操作步骤：**

1. **添加GameManagers预制体**
   - 将GameManagers.prefab拖入Main场景
   - 确认位置在(0, 0, 0)
   - 确认DontDestroyOnLoad设置正确

2. **创建UI Canvas**
   - 创建新Canvas，命名为"MainUICanvas"
   - 设置Render Mode: Screen Space - Overlay
   - 设置Canvas Scaler: Scale With Screen Size (1920x1080)
   - 添加GraphicRaycaster组件

3. **实例化UI预制体**
   - 实例化MainMenuPanel预制体到Canvas下
   - 实例化LoadingPanel预制体到Canvas下
   - 实例化PauseMenuPanel预制体到Canvas下

4. **配置UIManager引用**
   - 打开UIManager组件
   - 将各UI面板拖拽到对应插槽
   - 设置面板层级关系

5. **配置SceneLoader引用**
   - 打开SceneLoader组件
   - 关联LoadingPanel预制体
   - 设置进度条和文本引用

**验证标准：**
- [ ] Main场景包含GameManagers预制体
- [ ] Main场景包含UI Canvas
- [ ] 所有UI预制体正确实例化
- [ ] 控制台无引用缺失警告

---

### 任务4：管理器初始化流程测试

**测试场景：**

1. **启动测试**
   - 运行游戏进入Main场景
   - 观察控制台初始化日志
   - 确认管理器按顺序初始化（参考初始化日志标识）

2. **主菜单测试**
   - 确认显示主菜单UI
   - 测试各按钮点击响应
   - 测试设置/关于面板切换

3. **场景切换测试**
   - 点击"新游戏"
   - 观察Loading界面显示
   - 确认切换到Town场景

4. **暂停功能测试**
   - 进入Town场景后（场景切换完成）
   - 按Esc键呼出暂停菜单
   - 确认暂停菜单显示正常
   - 测试继续游戏、返回主菜单功能
   - 返回主菜单后再次进入游戏测试

---

## 美术资源需求清单

以下美术资源需要在今日工作开始前准备就绪，以便完成UI预制体的制作：

### UI界面资源

| 序号 | 资源名称 | 用途 | 规格要求 | 格式 |
|------|---------|------|----------|------|
| 1 | 主菜单背景图 | 主菜单全屏背景 | 1920x1080 | PNG |
| 2 | 游戏标题Logo | 主菜单标题显示 | 800x300 | PNG |
| 3 | 普通按钮背景 | 新游戏/继续等按钮 | 300x80 | PNG |
| 4 | 按钮悬停效果 | 鼠标悬停状态 | 300x80 | PNG |
| 5 | 按钮按下效果 | 鼠标按下状态 | 300x80 | PNG |
| 6 | 设置面板背景 | 设置菜单背景 | 600x400 | PNG |
| 7 | 关于面板背景 | 关于菜单背景 | 500x300 | PNG |
| 8 | 暂停菜单背景 | 半透明遮罩+面板 | 1920x1080 | PNG |
| 9 | 进度条背景 | 加载进度条底色 | 800x30 | PNG |
| 10 | 进度条填充 | 加载进度条填充 | 800x30 | PNG |
| 11 | 对话框背景 | NPC对话框底部 | 1800x200 | PNG |
| 12 | 继续箭头 | 对话继续提示 | 50x50 | PNG |

### 音效资源

| 序号 | 资源名称 | 用途 | 格式 |
|------|---------|------|------|
| 1 | 按钮点击音效 | 菜单按钮点击 | WAV/MP3 |
| 2 | 背景音乐 | 主菜单BGM | WAV/MP3 |
| 3 | 加载完成音效 | 场景加载完成 | WAV/MP3 |
| 4 | 打开菜单音效 | 打开暂停菜单 | WAV/MP3 |
| 5 | 关闭菜单音效 | 关闭菜单 | WAV/MP3 |

### 缺失资源处理

如果上述美术资源未准备完成，采取以下临时方案：
- 使用Unity默认UI组件（Color块、默认字体）临时搭建
- 音效可暂时使用代码生成或占位
- 正式资源到位后替换

---

## 今日完成检查清单

### 代码配置检查

- [ ] GameManagers.prefab包含全部10个子对象
- [ ] 每个管理器脚本正确挂载
- [ ] 组件间引用关系正确
- [ ] DontDestroyOnLoad设置正确
- [ ] 各管理器核心属性已配置

### UI预制体检查

- [ ] MainMenuPanel预制体创建完成
- [ ] PauseMenuPanel预制体创建完成
- [ ] LoadingPanel预制体创建完成
- [ ] DialoguePanel预制体创建完成
- [ ] 所有UI元素引用正确配置

### 场景整合检查

- [ ] Main场景包含GameManagers
- [ ] Main场景包含UI Canvas
- [ ] 运行游戏显示主菜单
- [ ] 控制台无错误/警告

### 功能测试检查

- [ ] 主菜单按钮响应正常
- [ ] Loading界面正常显示
- [ ] 场景切换正常（Main→Town）
- [ ] 暂停菜单正常呼出并可操作

---

## 后续工作预告

完成今日工作后，项目的下一步方向：

1. **角色系统开发**（下周）
   - PlayerController玩家控制器
   - 角色属性系统
   - 动画状态机

2. **交互系统开发**
   - NPC交互系统
   - 对话系统完善
   - 任务系统基础

3. **游戏内容填充**
   - 小镇场景搭建
   - 角色动画资源制作
   - 音效背景音乐配置

---

> **备注：** 如遇到技术难点或资源缺失导致进度受阻，请记录问题并及时沟通。
